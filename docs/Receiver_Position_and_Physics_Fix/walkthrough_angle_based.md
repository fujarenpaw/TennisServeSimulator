# 修正内容の確認 - 軌道コントロールの抜本的改善（角度ベース）

高い打点での制限や不自然な挙動を解消するため、軌道コントロールを「最高点」指定から「発射角度（仰角）」指定に切り替えました。

## 実施した変更

### 1. パラメータの切り替え
- **変更前**: 「最高点の高さ」「最高点の位置」で軌道を定義。
- **変更後**: 「発射角度（仰角）」「発射方向（左右）」で軌道を直接定義。
- **理由**: 高い打点（2.5m〜3m）から打ち下ろす場合、「最高点」を指定する方式では物理的に矛盾が生じやすく、意図した「直線的な鋭いサーブ」を作ることが困難であったためです。角度ベースにすることで、マイナスの角度（打ち下ろし）を直感的に設定できるようになりました。

### 2. UIの更新
- **コントロールパネル**: 最高点の設定を削除し、仰角（-30°〜45°）と左右角のスライダーを追加しました。
- **双方向の同期**: 
    - マーカー（緑の円）をドラッグすると、その地点へ飛ぶように自動で角度と速度が計算されます。
    - スライダーを動かすと、飛距離に応じてマーカー（緑の円）が実際の着弾地点へ移動します。

### 3. マーカーの操作性向上
- **サイズ拡大**: ターゲットマーカー（着弾点の緑の球体）のサイズを従来の 0.2 から 0.4 に拡大し、掴みやすくしました。
- **設定個所**: `src/graphics/TrajectoryVisualizer.ts` の 24行目です。さらに大きくしたい場合はここを変更してください。

## 検証結果

### 3m打点でのサーブ
- 打点を 3m に設定し、仰角をマイナス（例：-10.0°）に設定することで、サーバーから着弾点へ一直線に向かうプロのような高速サーブが再現できることを確認しました。

### 操作の整合性
- マーカーをドラッグして「着弾させたい場所」を決めると、150km/h以内で最適な角度が自動設定されます。その後、微調整したい場合にスライダーで角度を変更できるという、柔軟な操作感になりました。

## 修正ファイル
- [index.ts](file:///c:/Users/hoge/Documents/GitHub/TennisServeSimulator/src/types/index.ts): パラメータ定義の変更
- [PhysicsEngine.ts](file:///c:/Users/hoge/Documents/GitHub/TennisServeSimulator/src/core/PhysicsEngine.ts): 角度ベースのシミュレーションと最適化
- [ServeScene.tsx](file:///c:/Users/hoge/Documents/GitHub/TennisServeSimulator/src/features/serve/ServeScene.tsx): 初期状態と同期ロジックの更新
- [ControlPanel.tsx](file:///c:/Users/hoge/Documents/GitHub/TennisServeSimulator/src/components/ControlPanel.tsx): スライダーUIの刷新
