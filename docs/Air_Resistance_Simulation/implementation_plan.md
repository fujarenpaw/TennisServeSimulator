# 空気抵抗シミュレーション導入の実装計画

テニスのサーブにおいて、ボールが空気抵抗により減速する物理挙動をシミュレーターに導入します。これにより、現状の「速度が一定で飛びすぎる」現象を改善し、より現実的な弾道を再現します。

## 変更内容

### 物理エンジン (`src/core/PhysicsEngine.ts`)

空気抵抗（抗力）を考慮した運動方程式を導入します。

#### 抗力モデル
抗力 $F_d$ は速度の2乗に比例するモデルを使用します：
$F_d = \frac{1}{2} C_d \rho A v^2$

これを加速度 $a_d$ に換算すると：
$a_d = -k |v| \vec{v}$
ここで、$k = \frac{C_d \rho A}{2m}$ は空気抵抗係数です。テニスボールの場合、$k$ はおおよそ 0.02 前後の値となります。

#### 修正箇所 [MODIFY] [PhysicsEngine.ts](file:///c:/Users/hoge/Documents/GitHub/TennisServeSimulator/src/core/PhysicsEngine.ts)

1.  **定数の追加**:
    - `DRAG_COEFFICIENT` (k) を定義（初期値 0.021）。
2.  **`simulateTrajectory` の更新**:
    - 速度更新ステップにおいて、重力に加えて空気抵抗による減速度を計算し適用します。
3.  **解析関数の更新**:
    - `calculateLandingDistance` および `calculateHeightAtDistance` は現在、放物線（空気抵抗なし）の解析解を使用しています。
    - これらを、空気抵抗を考慮したシミュレーションベースの計算（または近似式）に置き換えることで、自動照準（最適化）機能との整合性を保ちます。

## 検証計画

### 自動テスト
- ユーザーの指示により不要。

### 手動検証
- サーバーを起動し、サーブを打った際に初速から徐々に速度が落ち、飛距離が以前よりも抑えられていることを確認する。
- 低速（100km/h以下）と高速（150km/h）での減衰の差が自然であることを確認する。
