# 空気抵抗シミュレーション導入の修正内容

テニスのサーブにおいて、ボールが空気抵抗により減衰する挙動を実装しました。

## 変更内容

### 物理エンジン (`src/core/PhysicsEngine.ts`)

- **空気抵抗モデルの導入**: 
  - 速度の2乗に比例する抗力（ドラッグ）を `simulateTrajectory` 内の各ステップで計算するようにしました。
  - $F_d = -k |v| \vec{v}$ のモデルを用いて、進行方向と逆向きの減速度を適用しています。
- **解析的計算からシミュレーションベースへの移行**:
  - 空気抵抗がある場合、放物線運動の単純な解析解（$y = y_0 + v_y t - \frac{1}{2}gt^2$ など）が使えなくなります。
  - そのため、ターゲットに当てるための角度計算 (`findLaunchAngleForDistance`) や、ネットを越えるかの判定 (`calculateHeightAtDistance`) を、内部で `simulateTrajectory` を呼び出すシミュレーションベースの算出に更新しました。これにより、自動照準（最適化）機能と実際の描画される弾道が正確に一致するようになります。

## 検証結果

### 弾道の変化
- 高速なサーブほど空気抵抗の影響を強く受け、これまでの一定速度での飛行に比べて終速が落ちるようになりました。
- これにより、サーブが「後ろに伸びすぎる」現象が改善され、より現実的なテニスの弾道に近づいています。

### 自動照準機能
- 最適化ロジックが空気抵抗を考慮したシミュレーションを回すようになったため、指示したターゲット位置に正確にボールが落ちることを確認してください。

render_diffs(file:///c:/Users/hoge/Documents/GitHub/TennisServeSimulator/src/core/PhysicsEngine.ts)
